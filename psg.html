<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSG News</title>
    <link rel="stylesheet" href="stylepsg.css"> 
    <link rel="script" href="v2.js">
</head>
<body>
    <header>
        <h1><span>Ma veille Technologique</span> <span class="white-text"> <br>Le meilleur club de France </span></h1>
        <nav>
            <a href="index.html">Accueil</a>
            <li><a href="ia.html">üí°ü§ñ Veille IA</a></li>
            <a href="jv.html"> üóûÔ∏èüéÆ Jeux Vid√©o</a>
            <li><a href="https://lucas-webdev.fr" target="_blank">üë®üèæ‚Äçüíªüåç Portfolio</a></li>
        </nav>
    </header>
</body>
<p> √¥ Ville Lumiere </p>
<main>
    <section id="rss-feed-psg">
        <p>Chargement des articles...</p>
    </section>

    <section id="projet">
        <h1><span>Le parc des princes </span> <span class="white-text"> <br> </span></h1>
        <a href="https://lucas-massako.github.io/Parc-des-Princes/" target="_blank">
            <br>
            <button>Le Stade Mythique du PSG</button>
        </a>
       
    </section>

   
    
</main>


<script>
    async function fetchIARSS() {
        const rssFeedElement = document.getElementById("rss-feed-psg");
        rssFeedElement.innerHTML = "<p>Chargement des articles...</p>";

        const RSS_FEEDS = [
        
       //{ name: "lequipe", url:"https://dwh.lequipe.fr/api/edito/rss?path=/Football/.xml"},
        { name:"google", url:"https://news.google.com/topics/CAAqIggKIhxDQkFTRHdvSkwyMHZNREZmTVd0ckVnSm1jaWdBUAE?ceid=FR:fr&oc=3.xml"},
       
       
        ];

        rssFeedElement.innerHTML = "";

        for (const feed of RSS_FEEDS) {
            try {
                const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(feed.url)}`);

                const data = await response.json();
                const parser = new DOMParser();
                const xml = parser.parseFromString(data.contents, "text/xml");

                const feedContainer = document.createElement("div");
                feedContainer.classList.add("rss-source");
                feedContainer.innerHTML = `<h3>${feed.name}</h3>`;

                displayRSS(xml, feedContainer);
                rssFeedElement.appendChild(feedContainer);

            } catch (error) {
                console.error(`Erreur lors de la r√©cup√©ration du flux RSS (${feed.name}) :`, error);
                rssFeedElement.innerHTML += `<p>Impossible de charger les articles de ${feed.name}.</p>`;
            }
        }
    }

    function displayRSS(xml, feedContainer) {
        const items = xml.querySelectorAll("item");
        let html = "";
        const uniqueLinks = new Set();
    
        items.forEach((item, index) => {
            if (index < 4) {
                const title = item.querySelector("title")?.textContent || "Sans titre";
                let link = item.querySelector("link")?.textContent || "#";
                const description = item.querySelector("description")?.textContent || "Pas de description";
                const image = item.querySelector("enclosure")?.getAttribute("url") || "";
    
                if (!uniqueLinks.has(link)) {
                    uniqueLinks.add(link);
                    html += `
                        <div class="article">
                            <a href="${link}" target="_blank">${title}</a>
                            <p>${description}</p>
                            
                            <button onclick="saveArticle('${title}', '${link}', '${description}')" >‚ù§Ô∏è Aimer</button>
                        </div>
                    `;
                }
            }
        });
    
        feedContainer.innerHTML += html || "<p>Aucun article disponible.</p>";
    }

    function saveArticle(title, link, image, description) {
        let savedArticles = JSON.parse(localStorage.getItem("likedArticles")) || [];
    
        if (!savedArticles.some(article => article.link === link)) {
            savedArticles.push({ title, link, image, description });
            localStorage.setItem("likedArticles", JSON.stringify(savedArticles));
            alert("Article ajout√© aux favoris !");
        } else {
            alert("Cet article est d√©j√† dans vos favoris.");
        }
    }

    fetchIARSS();
</script>
</body>
</html>