<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veille IA</title>
    <link rel="stylesheet" href="style.css"> 
    <script src="v2.js"></script>
</head>
<body>
    <header>
        <h1><span>Ma veille Technologique</span> <span class="white-text"> <br>L'intelligence Artificie</span></h1>
        <nav>
            <a href="index.html">Accueil</a>
            <a href="jv.html"> üóûÔ∏èüéÆ Jeux Vid√©o</a>
            <a href="psg.html">‚ù§Ô∏èüíô PSG</a>
            <li><a href="https://lucas-webdev.fr" target="_blank">üë®üèæ‚Äçüíªüåç Portfolio</a></li>
        </nav>
    </header>
    
    <main>
        <section id="rss-feed">
            <h2>Actualit√©s sur l'IA</h2>
            <p>Chargement des articles...</p>
        </section>
    </main>
    
    <script>
        function normalizeLink(link) {
            return link.replace(/&amp;/g, "&").trim();
        }
        async function fetchIARSS() {
            const rssFeedElement = document.getElementById("rss-feed");
            rssFeedElement.innerHTML = "<p>Chargement des articles...</p>";

            const RSS_FEEDS = [
                { name: "Google News", url: "https://news.google.com/rss/search?q=intelligence+artificielle&hl=fr&gl=FR&ceid=FR:fr.xml" },
                { name: "Le Monde", url: "https://www.lemonde.fr/pixels/rss_full.xml" },
               
            ];

            rssFeedElement.innerHTML = "";

            for (const feed of RSS_FEEDS) {
                try {
                    const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(feed.url)}`);
                    const data = await response.json();
                    const parser = new DOMParser();
                    const xml = parser.parseFromString(data.contents, "text/xml");

                    const feedContainer = document.createElement("div");
                    feedContainer.classList.add("rss-source");
                    feedContainer.innerHTML = `<h2>${feed.name}</h2>`;

                    displayRSS(xml, feedContainer);
                    rssFeedElement.appendChild(feedContainer);

                } catch (error) {
                    console.error(`Erreur lors de la r√©cup√©ration du flux RSS (${feed.name}) :`, error);
                    rssFeedElement.innerHTML += `<p>Impossible de charger les articles de ${feed.name}.</p>`;
                }
            }
        }
        function normalizeText(str) {
            return str
                .toLowerCase()
                .normalize("NFD")
                .replace(/[\u0300-\u036f]/g, "") // Supprime les accents
                .replace(/['‚Äô"]/g, "") // Supprime les guillemets/apostrophes
                .trim();
        }
        
        function displayRSS(xml, feedContainer, feedName) {
            const items = xml.querySelectorAll("item");
            let html = "";
            const uniqueLinks = new Set();
        
            items.forEach((item, index) => {
                if (index < 4) { // Limite √† 4 articles par source
                    let title = item.querySelector("title")?.textContent.trim() || "Sans titre";
                    let link = normalizeLink(item.querySelector("link")?.textContent || "#");
                    let description = item.querySelector("description")?.textContent.trim() || "Pas de description";
                    let source = item.querySelector("source")?.textContent.trim() || "";
                    let image = item.querySelector("media\\:content, enclosure")?.getAttribute("url") || "";
        
                    // V√©rifie si la source est d√©j√† dans le titre (insensible √† la casse et aux accents)
                    let showSource = source && !normalizeText(title).includes(normalizeText(source));
        
                    if (!uniqueLinks.has(link)) {
                        uniqueLinks.add(link);
                        html += `
                            <div class="article">
                                <a href="${link}" target="_blank"><strong>${title}</strong></a>
                                ${showSource ? `<p class="source">${source}</p>` : ""}
                                <p>${description}</p>
                                <button onclick="saveArticle(
                                    '${title.replace(/'/g, "‚Äô").replace(/"/g, "‚Äù")}',
                                    '${link}',
                                    '${image}',
                                    '${description.replace(/'/g, "‚Äô").replace(/"/g, "‚Äù")}'
                                )">‚ù§Ô∏è Ajouter aux favoris</button>
                            </div>
                        `;
                    }
                }
            });
        
            feedContainer.innerHTML += html || "<p>Aucun article disponible.</p>";
        }
        
        
        
            
        

        function saveArticle(title, link, image, description) {
            let savedArticles = JSON.parse(localStorage.getItem("likedArticles")) || [];
        
            if (!savedArticles.some(article => article.link === link)) {
                savedArticles.push({ title, link, image, description });
                localStorage.setItem("likedArticles", JSON.stringify(savedArticles));
                alert("Article ajout√© aux favoris !");
            } else {
                alert("Cet article est d√©j√† dans vos favoris.");
            }
        }

        fetchIARSS();

       
    </script>
</body>
</html>